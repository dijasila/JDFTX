<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Oxide surfaces</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('OxideSurfaces.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Oxide surfaces </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><center><table border="0">
<tr>
<td><div class="image">
<img src="TiO2surfaceNbound.png" alt=""/>
</div>
 </td><td>&#160; &#160; </td><td><div class="image">
<img src="TiO2surfaceDtot.png" alt=""/>
</div>
 </td></tr>
</table>
</center><p>This tutorial introduces the setup of more complex surfaces, and demonstrates bound charge and electrostatic potential visualization, using the example of Rutile TiO<sub>2</sub>(110) in vacuum and solution.</p>
<h2><a class="anchor" id="autotoc_md43"></a>
Bulk Rutile TiO&lt;sub&gt;2&lt;/sub&gt;</h2>
<p>Let's start with a calculation of the bulk titanium dixoide, which has a Rutile crystal structure consisting of a tetragonal unit cell with parameters a = 4.59 Angstroms (8.67 bohrs) and c = 2.96 Angstroms (5.59 bohrs). Each unit cell contains two TiO<sub>2</sub> units, with one Ti at a vertex and the other at the body center. To speed up the calculations, we skip geometry optimization in this tutorial, and I directly list the optimized ionic positions below. </p><pre class="fragment">#Save the following to bulk.in:
ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100

lattice Tetragonal 8.67 5.59
ion Ti   0.5000 0.5000 0.5   1
ion Ti   0.0000 0.0000 0.0   1
ion  O   0.6958 0.6958 0.0   1
ion  O   0.8042 0.1958 0.5   1
ion  O   0.3042 0.3042 0.0   1
ion  O   0.1958 0.8042 0.5   1

kpoint-folding 4 4 6   #Less kpoints along longer lattice vectors
electronic-SCF
dump End None
</pre><p> Run jdftx on bulk.in, use createXSF to generate bulk.xsf and visualize it using VESTA, as usual.</p>
<div class="image">
<img src="TiO2bulk.png" alt=""/>
</div>
<p>Note that each Ti atom is surrounded by six O atoms in a (distorted) octahedron, and that each O atom connects to three Ti atoms in a plane. Record the total energy of the bulk unit cell, as we will need it later for calculating surface energies.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
Rutile TiO&lt;sub&gt;2&lt;/sub&gt;(110) surface: setup</h2>
<p>We will follow the procedure introduced in the <a class="el" href="Pt100.html">Pt(100) setup</a> page to setup the surface geometry, with a few additions to account for the differences. This time, we will make a slab with three layers (to keep the calculations quicker) and include a vacuum spacing of approximately 15 bohrs as before. For production calculations, converge the results with number of layers.</p>
<p>The original tetragonal lattice vectors (in columns) are: </p><pre class="fragment">    / a 0 0 \
R = | 0 a 0 |
    \ 0 0 c /
</pre><p> The 110 surface normal must combine the first two lattice vectors (this time the third axis is different from the first two) with equal coefficients, leading to the obvious choice [ 1 1 0 ]. We now need two perpendicular directions for the in-plane superlattice vectors. Note that [ -1 1 0 ] is a combination of the first two lattice vectors which is perpendicular to the chosen surface normal. The third lattice vector is already normal to both of these, so can become a superlattice vector unmodified (combination [ 0 0 1 ]). Therefore, we arrive at the transformation matrix (above combinations in columns): </p><pre class="fragment">    / -1  0  1 \
M = |  1  0  1 |
    \  0  1  0 /
</pre><p> and the resulting superlattice vectors: </p><pre class="fragment">                / -a  0  a \
Rsup = R . M =  |  a  0  a |
                \  0  c  0 /
</pre><p> The supercell has twice the volume of the unit cell since det(M) = 2, and therefore we need two copies of the atoms. We can take the original atom coordinates and transform them to supercell fractional coordinates by multiplying by inv(M): </p><pre class="fragment">ion Ti   0.0000  0.5  0.5000  1
ion Ti   0.0000  0.0  0.0000  1
ion  O   0.0000  0.0  0.6958  1
ion  O  -0.3042  0.5  0.5000  1
ion  O   0.0000  0.0  0.3042  1
ion  O   0.3042  0.5  0.5000  1
</pre><p> For the second set of atoms, we add an offset of [ 1 0 0 ] in the original lattice coordinates (any original lattice vector that has a component along the surface normal will work), which upon multiplying by inv(M), becomes an offset of [ -1/2 0 1/2 ] in the superlattice coordinates. Putting together the second set of atoms with this offset, wrapping all coordinates into the range [0,1) using periodicity, and sorting atoms by the third coordinate, we get: </p><pre class="fragment">ion Ti   0.0000  0.0  0.0000  1
ion Ti   0.5000  0.5  0.0000  1
ion  O   0.1958  0.5  0.0000  1
ion  O   0.8042  0.5  0.0000  1
ion  O   0.5000  0.0  0.1958  1
ion  O   0.0000  0.0  0.3042  1

ion Ti   0.0000  0.5  0.5000  1
ion Ti   0.5000  0.0  0.5000  1
ion  O   0.6958  0.5  0.5000  1
ion  O   0.3042  0.5  0.5000  1
ion  O   0.0000  0.0  0.6958  1
ion  O   0.5000  0.0  0.8042  1
</pre><p> Note that this looks like two layers consisting of two TiO<sub>2</sub> units each, which is what we need in order to cleave and get a surface. However note that each layer is lopsided: it consists of two Ti and two O atoms all with the same third coordinate (0.0 or 0.5 depending on the layer), and the remaining two O atoms to the same side of this sheet, one closer and the other further away. By wrapping the third coordinate of the last O atom using periodicity, we can make both layers symmetric with one O atom above and below each Ti<sub>2</sub>O<sub>2</sub> sheet: </p><pre class="fragment">ion  O   0.5000  0.0 -0.1958  1
ion Ti   0.0000  0.0  0.0000  1
ion Ti   0.5000  0.5  0.0000  1
ion  O   0.1958  0.5  0.0000  1
ion  O   0.8042  0.5  0.0000  1
ion  O   0.5000  0.0  0.1958  1

ion  O   0.0000  0.0  0.3042  1
ion Ti   0.0000  0.5  0.5000  1
ion Ti   0.5000  0.0  0.5000  1
ion  O   0.6958  0.5  0.5000  1
ion  O   0.3042  0.5  0.5000  1
ion  O   0.0000  0.0  0.6958  1
</pre><p> Two layers have thickness sqrt(2)a (the third superlattice vector length) = 12.26123 bohrs, so three layers occupy approximately 18.4 bohrs. We will make the net unit cell height 33 bohrs to include 15 bohrs vacuum spacing, which requires scaling the third atom fractional coordinates by 12.26123/33 = 0.37155, and offsetting layers by the same amount. By selecting three layers symmetrically about zero, we arrive at the geometry: </p><pre class="fragment">#Save the following to Rutile110.ionpos:
ion  O   0.0000  0.0 -0.25852  1
ion Ti   0.0000  0.5 -0.18578  1
ion Ti   0.5000  0.0 -0.18578  1
ion  O   0.6958  0.5 -0.18578  1
ion  O   0.3042  0.5 -0.18578  1
ion  O   0.0000  0.0 -0.11303  1

ion  O   0.5000  0.0 -0.07275  1
ion Ti   0.0000  0.0  0.00000  1
ion Ti   0.5000  0.5  0.00000  1
ion  O   0.1958  0.5  0.00000  1
ion  O   0.8042  0.5  0.00000  1
ion  O   0.5000  0.0  0.07275  1

ion  O   0.0000  0.0  0.11303  1
ion Ti   0.0000  0.5  0.18578  1
ion Ti   0.5000  0.0  0.18578  1
ion  O   0.6958  0.5  0.18578  1
ion  O   0.3042  0.5  0.18578  1
ion  O   0.0000  0.0  0.25852  1
</pre><p> with the lattice vectors: </p><pre class="fragment">#Save the following to Rutile110.lattice:
lattice Orthorhombic 12.26123 5.59 33   #Respectively sqrt(2)a, c and chosen height with spacing
</pre><p> Use testGeometry.in from the <a class="el" href="Pt100.html">Pt(100) setup</a> page to visualize the geometry via a JDFTx dry run. You should see a structure as shown at the top of the page (except without the bound charge distributions, which we will calculate below).</p>
<h2><a class="anchor" id="autotoc_md45"></a>
Rutile TiO&lt;sub&gt;2&lt;/sub&gt;(110) surface: calculations</h2>
<p>Now we can create input files for vacuum and solvated surface calculations, exactly as in the <a class="el" href="MetalSurfaces.html">Metal surfaces</a> tutorial, with a few minor tweaks: we can use fewer k-points and don't need Fermi fillings since this is an insulator, and we will output electrostatic potentials and bound charge for visualization. </p><pre class="fragment">#Save the following to common.in:
include Rutile110.lattice
include Rutile110.ionpos
ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100
coulomb-interaction Slab 001
coulomb-truncation-embed 0 0 0
kpoint-folding 3 6 1       #Chosen in inverse proportion to lattice vector length
lcao-params 30             #More initialization steps for a better starting point
electronic-SCF


#Save the following to Vacuum.in:
include common.in
dump-name Vacuum.$VAR
dump End State Dtot


#Save the following to Solvated.in:
include common.in
initial-state Vacuum.$VAR
dump-name Solvated.$VAR
dump End Dtot BoundCharge
fluid LinearPCM
pcm-variant CANDLE
fluid-solvent H2O
fluid-cation Na+ 1.
fluid-anion F- 1.
</pre><p> Then run both the vacuum and solvated calculations (these will take a while): </p><pre class="fragment">jdftx -i Vacuum.in | tee Vacuum.out
jdftx -i Solvated.in | tee Solvated.out
createXSF Solvated.out Solvated.xsf nbound
</pre><p> and visualize the resulting XSF file with VESTA to see the structure with the bound charge distribution in the solvent (as shown at the top of this page, after adjusting the boundary setting in VESTA as described previously). Notice the positive bound charge near the oxygen bridges at the surface and the negative bound charge in the solvent near the exposed Ti atoms at the surface.</p>
<p>Adapt collectResults.sh from the <a class="el" href="MetalSurfaces.html">Metal surfaces</a> tutorial to extract and report the surface energies in vacuum and solution. In this case, we do not have electron chemical potential (mu) output to track because we disabled Fermi fillings. To understand the effect of band positions, we could instead use the EigStats output and compare the VBM (HOMO) energies. For demonstration purposes, however, we will extract the solvation shift from the total electrostatic potential (Dtot) output instead, as described in the next section.</p>
<center><table class="doxtable">
<tr>
<th rowspan="2">Model </th><th colspan="3">E<sub>surf</sub> [eV/nm<sup>2</sup>] </th><th rowspan="2">VBM shift [eV] </th></tr>
<tr>
<th>Vacuum </th><th>Solvated </th><th>Shift </th></tr>
<tr>
<td>CANDLE </td><td rowspan="2">8.58 </td><td>6.78 </td><td>-1.80 </td><td>1.04 </td></tr>
<tr>
<td>GLSSA13 </td><td>2.50 </td><td>-6.08 </td><td>3.15 </td></tr>
</table>
</center><p>Note that the surface energy reduction due to solvent stabilization is much larger compared to the metal surface case because of the positive (Ti) and negative (O) charge regions on the surface. The VBM shift predicted by CANDLE (extracted using the scripts below) is in good agreement with experimental estimates (0.9-1.1 eV). But this agreement is somewhat fortuitous: converging the result with number of layers and geometry opimization lowers the predicted shift to 0.6 eV and worsens agreement somewhat. See Refs. <a class="el" href="citelist.html#CITEREF_ElectrostaticPotential">[33]</a> and <a class="el" href="citelist.html#CITEREF_BandAlignmentGW">[3]</a> for further discussion of energy level alignment in oxide-water interfaces.</p>
<p>For comparison, I also show results for the GLSSA13 LinearPCM (same as VASPsol, similar to SCCS). Note that those solvation models have two fundamental difficulties with oxide surfaces resulting in poor convergence and unphysical results:</p>
<ol type="1">
<li>Leakage of fluids into small voids in the crystal</li>
<li>Not parametrized for transition metal atoms exposed to solution</li>
</ol>
<p>By starting from the non-empirical and nonlocally-determined SaLSA cavity, CANDLE and SaLSA address both these issues. The non-locality ensures that an entire water molecule must fit in the voids, significantly minimizing the probability of unphysical leakage. Additionally, the density-product cavity determination is calibrated to work on all atoms in the periodic table, and not just organic solutes.</p>
<h2><a class="anchor" id="autotoc_md46"></a>
Electrostatic potentials</h2>
<p>We will now extract the electrostatic potential output from both the vacuum and solvated calculations (Vacuum.d_tot and Solvated.d_tot). The difference between these electrostatic potentials goes to zero far away from the slab, and approaches a constant value towards the center of the slab. This potential shift in the center fo the slab corresponds to the shift in the bulk energy levels of the solid due to the interfacial potential at the solid-liquid interface, which is the solvation VBM shift we seek.</p>
<p>The following python script extracts the potentials, planarly averages them perpendicular to the slab normal (z) direction, plots the difference and reports the VBM shift. </p><pre class="fragment">import numpy as np
import matplotlib.pyplot as plt

S = [ 56, 28, 160 ]            #Sample count (fftbox from log file)
L = [ 12.26123, 5.59, 33. ]    #Lattice vector lengths (bohrs)
z = np.arange(S[2])*L[2]/S[2]  #z-coordinates of grid points

def readPlanarlyAveraged(fileName, S):
    out = np.fromfile(fileName, dtype=np.float64)
    out = np.reshape(out, S)   #Reshape data
    out = np.mean(out, axis=1) #y average
    out = np.mean(out, axis=0) #x average
    return out

dVacuum = readPlanarlyAveraged('Vacuum.d_tot',S)
dSolvated = readPlanarlyAveraged('Solvated.d_tot',S)
dShift = dSolvated - dVacuum

print "VBMshift =", dShift[0]*27.2114  #Report VBM shift in eV
plt.plot(z*0.529, dShift*27.2114);     #Plot with unit conversions
plt.xlabel('z [Angstroms]')
plt.ylabel('Potential [eV]')
plt.xlim([0, L[2]/2*0.529])            #Select first half (top surface only)
plt.show()
</pre><p> This Octave/MATLAB script achieves the same result, with some minor differences due to data ordering: </p><pre class="fragment">S = [ 56 28 160 ];          %Sample count
L = [ 12.26123 5.59 33 ];   %Lattice vector lengths (bohrs)
z = [0:S(3)-1]*L(3)/S(3);   %z-coordinates of grid points

function out = readPlanarlyAveraged(fileName, S)
    %Read data:
    fp = fopen(fileName, 'r');
    out = fread(fp, 'double');
    fclose(fp);
    out = reshape(out, fliplr(S)); %Reshape data (flipped order)
    out = mean(mean(out,2),3);     %xy average (flipped order)
end

dVacuum = readPlanarlyAveraged('Vacuum.d_tot',S);
dSolvated = readPlanarlyAveraged('Solvated.d_tot',S);
dShift = dSolvated - dVacuum;

VBMshift = dShift(1)*27.2114   %Report VBM shift in eV
plot(z*0.529, dShift*27.2114); %Plot with unit conversions
xlabel('z [Angstroms]');
ylabel('Potential [eV]');
xlim([0 L(3)/2]*0.529);        %Select first half (top surface only)
pause
</pre><p> The resulting potential plot is shown at the top of the page. Note the oscillating response in the outer layers of the slab which decays towards the constant value in the center. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
