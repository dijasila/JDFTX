<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: ExactExchange Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classExactExchange.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classExactExchange-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ExactExchange Class Reference<div class="ingroups"><a class="el" href="group__ElectronicDFT.html">Electronic DFT</a> &raquo; <a class="el" href="group__ExchangeCorrelation.html">Exchange-correlation terms</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Exact-exchange calculator.  
 <a href="classExactExchange.html#details">More...</a></p>

<p><code>#include &lt;ExactExchange.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0493fb1a1da53043cfcd9342a54f75d5"><td class="memItemLeft" align="right" valign="top"><a id="a0493fb1a1da53043cfcd9342a54f75d5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ExactExchange</b> (const <a class="el" href="classEverything.html">Everything</a> &amp;e)</td></tr>
<tr class="separator:a0493fb1a1da53043cfcd9342a54f75d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2538022c4828c227f139610f4617477c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classExactExchange.html#a2538022c4828c227f139610f4617477c">operator()</a> (double aXX, double omega, const std::vector&lt; <a class="el" href="classdiagMatrix.html">diagMatrix</a> &gt; &amp;F, const std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; &amp;C, std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; *HC=0, <a class="el" href="classmatrix3.html">matrix3</a>&lt;&gt; *EXX_RRT=0, bool rpaMode=false, const std::vector&lt; <a class="el" href="classdiagMatrix.html">diagMatrix</a> &gt; *Hsub_eigs=0) const</td></tr>
<tr class="separator:a2538022c4828c227f139610f4617477c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb08efd47141f727d3fc5dfe9ac056f5"><td class="memItemLeft" align="right" valign="top"><a id="afb08efd47141f727d3fc5dfe9ac056f5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classExactExchange.html#afb08efd47141f727d3fc5dfe9ac056f5">prepareHamiltonian</a> (double omega, const std::vector&lt; <a class="el" href="classdiagMatrix.html">diagMatrix</a> &gt; &amp;F, const std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; &amp;C)</td></tr>
<tr class="memdesc:afb08efd47141f727d3fc5dfe9ac056f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the ACE (Adiabatic Compression of Exchange) representation in preparation for applyHamiltonian. <br /></td></tr>
<tr class="separator:afb08efd47141f727d3fc5dfe9ac056f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada190debc8ec280fe3322af38eb77610"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classExactExchange.html#ada190debc8ec280fe3322af38eb77610">applyHamiltonian</a> (double aXX, double omega, int q, const <a class="el" href="classdiagMatrix.html">diagMatrix</a> &amp;Fq, const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;Cq, <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;HCq) const</td></tr>
<tr class="separator:ada190debc8ec280fe3322af38eb77610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1382f0dbbcc78f91087895434edf671"><td class="memItemLeft" align="right" valign="top"><a id="ad1382f0dbbcc78f91087895434edf671"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classExactExchange.html#ad1382f0dbbcc78f91087895434edf671">addHamiltonian</a> (double aXX, double omega, int q, <a class="el" href="classmatrix.html">matrix</a> &amp;H, const std::vector&lt; int &gt; &amp;iRowsMine, const std::vector&lt; int &gt; &amp;iColsMine) const</td></tr>
<tr class="memdesc:ad1382f0dbbcc78f91087895434edf671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add Hamiltonian in plane-wave basis (used for dense diagonalization for BGW): <br /></td></tr>
<tr class="separator:ad1382f0dbbcc78f91087895434edf671"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Exact-exchange calculator. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ada190debc8ec280fe3322af38eb77610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada190debc8ec280fe3322af38eb77610">&#9670;&nbsp;</a></span>applyHamiltonian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ExactExchange::applyHamiltonian </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>aXX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdiagMatrix.html">diagMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>Fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;&#160;</td>
          <td class="paramname"><em>Cq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;&#160;</td>
          <td class="paramname"><em>HCq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply Hamiltonian using ACE representation initialized previously, and return the exchange energy contribution from current q. Note that fillings Fq are only used for computing the energy, and do not impact the Hamiltonian which only depends on F used in <a class="el" href="classExactExchange.html#afb08efd47141f727d3fc5dfe9ac056f5" title="Initialize the ACE (Adiabatic Compression of Exchange) representation in preparation for applyHamilto...">prepareHamiltonian()</a>. HCq must be allocated (non-null) in order to collect the Hamiltonian contribution, else only energy is returned. </p>

</div>
</div>
<a id="a2538022c4828c227f139610f4617477c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2538022c4828c227f139610f4617477c">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ExactExchange::operator() </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>aXX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classdiagMatrix.html">diagMatrix</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; *&#160;</td>
          <td class="paramname"><em>HC</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmatrix3.html">matrix3</a>&lt;&gt; *&#160;</td>
          <td class="paramname"><em>EXX_RRT</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rpaMode</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classdiagMatrix.html">diagMatrix</a> &gt; *&#160;</td>
          <td class="paramname"><em>Hsub_eigs</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute scaled exact exchange energy with scale aXX and range omega (and optionally accumulate gradients) given fillings and wavefunctions. If prepareHamiltonian has been called with the same omega already, then the ACE representation is used to compute the energy and HC instead, except when lattice gradient or RPA-mode are requested which require full computation. RPA mode additionally requires electronic eigenvalues E. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>electronic/ExactExchange.h</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <li class="navelem"><a class="el" href="classExactExchange.html">ExactExchange</a></li>
</div>
</body>
</html>
