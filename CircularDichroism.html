<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Circular Dichroism (CD)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('CircularDichroism.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Circular Dichroism (CD) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="CD.png" alt=""/>
</div>
<p>This tutorial introduces the framework for computing the CD of a crystalline system. Previous theoretical methods employ a sum-over-states identity with momentum eigenvalues to calculate the CD. Our novel approach directly computes the orbital angular momentum (L) and electric quadripole (Q) matrix elements, which are then used in a post-processing script to find the CD signal (see [<a href="https://doi.org/10.48550/arXiv.2303.02764">https://doi.org/10.48550/arXiv.2303.02764</a>] for theoretical background).</p>
<p>For our system, we choose chiral metal CoSi due to the simplicity of its unit cell, though the computational framework can be generalized to any crystalline system of arbitrary unit cell complexity. This can also be applied to molecules, given they are placed in a box of sufficient size.</p>
<p>Beginning from a self-consistent energy density calculation, we use Monte-Carlo sampling to ensure an even sampling of the Brillouin Zone. To do so, we create 10 directories, each corresponding to a block of k-points, labeled "block_1", etc. Each block contains a "sampling.kpoints.in" file which contains a unique set of 250 randomly-generated k-points. We use a total of 2,500 k-points for sampling this system, though each system should be tested for convergence with respect to sampled k-points.</p>
<p>Each block also contains the input file, sampling.in: </p><pre class="fragment">include ../totalE.lattice
include ../totalE.ionpos
include sampling.kpoints.in

ion-species GBRV/$ID_pbe.uspp
elec-cutoff 50
elec-ex-corr gga-PBE

#Computing enough DFT bands to cover a desired energy range
elec-n-bands 100

#Fix the electron density (not self-consistent)
fix-electron-density ../totalE.$VAR

#Parameters specific to calculating finite difference derivative. Should be checked for each system
Cprime-params 7E-4
electronic-minimize energyDiffThreshold 5e-9
    Â 
dump End BandEigs Momenta L Q BandProjections
dump-name bandstruct.$VAR
</pre><p>which can be run using: </p><pre class="fragment">mpirun -n 4 jdftx -i sampling.in | tee sampling.out
</pre><p> Once done, each block should now contain the necessary components for calculating CD: the energies (bandstruct.eigenvals), momentum (bandstruct.momenta), orbital angular momentum (bandstruct.L), and quadrupole (bandstruct.Q) matrix elements. The bandstruct.BandProjections file can be dumped optionally if one wants to decompose the CD signal into individual orbital contributions.</p>
<p>After the sampling job has been completed for each block of k-points, the internal CD script included in JDFTx can be used to compile the data and compute the CD.</p>
<p>This script contains the following input flags: </p><pre class="fragment">--dmu, the change in mu relative to mu (if available), or VBM of DFT calculation [eV] (required)
--n_blocks, the number of blocks of k-points (required)
--n_bands, the number of computed DFT bands (required)
--domega, the bin size for histogramming [eV] (optional)
--omegaMax, the frequency cutoff of CD signal [eV] (optional)
--T, the temperature at which to compute CD [K] (optional)
--omegaAnalysis, the frequencies at which to decompose the CD signal into organic/inorganic/mixed contributions [eV] (optional)
</pre><p> To compute CD using default settings of domega=0.1eV, omegaMax=10eV, T=298K, and no frequencies for analysis, we can run: </p><pre class="fragment">CD --dmu 0 --n_blocks 10 --n_bands 100
</pre><p> which will output the computed CD in CDpy_10_100.dat (or, generally, CDpy_{n_blocks}_{n_bands}.dat). Note that this data file contains the CD tensor at each energy value from 0 to omegaMax, with spacing of domega. The header of the data file shows the order of the listed values for each row, with the first being the energy value and the following six being the six directional components of the tensor. Note that the output CD signal is in units of inverse Naperian length. See [<a href="https://doi.org/10.48550/arXiv.2303.02764">https://doi.org/10.48550/arXiv.2303.02764</a>] for unit conversion to standard molar circular dichroism.</p>
<p>We can plot the CD signal using a simple python script: </p><pre class="fragment">#!/usr/bin/env python
import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter1d

CD = np.loadtxt('CDpy_10_100.dat')
omega = CD[:,0]

plt.plot(omega, gaussian_filter1d(CD[:,1],2), color='r')
plt.axhline(0., color='k', ls='dotted', lw=1)
plt.xlim(0., 10.)
plt.xlabel(r'$\hbar\omega$ [eV]')
plt.ylabel(r'CD [$cm^{-1}$]')
plt.legend(loc='upper left', bbox_to_anchor=(1,1))

plt.savefig('CD.png', bbox_inches='tight')
plt.show()
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
